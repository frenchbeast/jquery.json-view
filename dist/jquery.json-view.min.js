(function(c){var b=function(e){var d=c("<span />",{"class":"collapser",on:{click:function(){var g=c(this);g.toggleClass("collapsed");var h=g.parent().children(".block");var f=h.children("ul");if(g.hasClass("collapsed")){f.hide();h.children(".dots, .comments").show()}else{f.show();h.children(".dots, .comments").hide()}}}});if(e){d.addClass("collapsed")}return d};var a=function(e,g){var d=c.extend({},{nl2br:true},g);var h=function(j){if(!j.toString()){return""}return j.toString().replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")};var f=function(k,j){return c("<span />",{"class":j,html:h(k)})};var i=function(o,p){switch(c.type(o)){case"object":if(!p){p=0}var k=c("<span />",{"class":"block"});var l=Object.keys(o).length;if(!l){return k.append(f("{","b")).append(" ").append(f("}","b"))}k.append(f("{","b"));var j=c("<ul />",{"class":"obj collapsible level"+p});c.each(o,function(q,s){l--;var r=c("<li />").append(f('"',"q")).append(q).append(f('"',"q")).append(": ").append(i(s,p+1));if(["object","array"].indexOf(c.type(s))!==-1&&!c.isEmptyObject(s)){r.prepend(b())}if(l>0){r.append(",")}j.append(r)});k.append(j);k.append(f("...","dots"));k.append(f("}","b"));if(Object.keys(o).length===1){k.append(f("// 1 item","comments"))}else{k.append(f("// "+Object.keys(o).length+" items","comments"))}return k;case"array":if(!p){p=0}var l=o.length;var k=c("<span />",{"class":"block"});if(!l){return k.append(f("[","b")).append(" ").append(f("]","b"))}k.append(f("[","b"));var j=c("<ul />",{"class":"obj collapsible level"+p});c.each(o,function(q,s){l--;var r=c("<li />").append(i(s,p+1));if(["object","array"].indexOf(c.type(s))!==-1&&!c.isEmptyObject(s)){r.prepend(b())}if(l>0){r.append(",")}j.append(r)});k.append(j);k.append(f("...","dots"));k.append(f("]","b"));if(o.length===1){k.append(f("// 1 item","comments"))}else{k.append(f("// "+o.length+" items","comments"))}return k;case"string":o=h(o);if(/^(http|https|file):\/\/[^\s]+$/i.test(o)){return c("<span />").append(f('"',"q")).append(c("<a />",{href:o,text:o})).append(f('"',"q"))}if(d.nl2br){var m=/\n/g;if(m.test(o)){o=(o+"").replace(m,"<br />")}}var n=c("<span />",{"class":"str"}).html(o);return c("<span />").append(f('"',"q")).append(n).append(f('"',"q"));case"number":return f(o.toString(),"num");case"undefined":return f("undefined","undef");case"null":return f("null","null");case"boolean":return f(o?"true":"false","bool")}};return i(e)};return c.fn.jsonView=function(e,d){var f={nl2br:true,collapse_all:false,collapse_first:false};if(d){c.extend(f,d)}return this.each(function(){var h=this;if(typeof e==="string"){try{e=JSON.parse(e)}catch(g){}}c(h).append(c("<div />",{"class":"json-view"}).append(a(e,d)));if(f.collapse_all){c(h).find("span.collapser").click()}else{if(f.collapse_first){c(h).find("ul > li > span.collapser").click()}}})}})(jQuery);